library(readxl)
install.packages(c("tidyverse", "data.table", "janitor", "readxl", "openxlsx", ))
install.packages(c("tidyverse", "data.table", "janitor"))
install.packages(c("readxl", "openxlsx"))
install.packages(c("psych", "car", "mice", "naniar"))
library(readxl)
df <- read_excel("risk_factors.xlsx")
head(df)
View(df)
glimpse(df)
glimpse(df)
# Nạp toàn bộ các gói cần thiết
library(tidyverse)   # xử lý, trực quan hóa dữ liệu
library(readxl)      # đọc file Excel (.xlsx)
library(openxlsx)    # ghi/xuất Excel
library(psych)       # thống kê mô tả, kiểm định tâm lý
library(car)         # hồi quy, kiểm định mở rộng
library(mice)        # bù dữ liệu thiếu
library(naniar)      # kiểm tra & trực quan hóa dữ liệu thiếu
df <- read_excel("risk_factors.xlsx")
head(df)
glimpse(df)
str(df)
miss_var_summary(df)
print(n = 35)
print(df, n = 50)
miss_var_summary(df)
print(n = ...)
print(miss_var_summary(df), n = Inf)
miss_var_summary(df)
print(miss_var_summary(df), Inf)
View(miss_var_summary(df))
gg_miss_var(df)
gg_miss_upset(df)
vis_miss(df, sort_miss = TRUE, cluster = TRUE)
vis_miss(df, sort_miss = TRUE, cluster = TRUE)
gg_miss_case(df)
head(df,1)
View(head(df,1))
vis_miss(df, sort_miss = TRUE, cluster = TRUE)
mcar_test(df)
str(df)
View(str(df))
View(miss_var_summary(df))
miss_var_summary(df)
pirnt(miss_var_summary(df), n = Inf)
print(miss_var_summary(df), n = Inf)
colSums(is.na(df)) == nrow(df)
sapply(df, function(x) length(unique(na.omit(x))) == 1)
names(df)[sapply(df, function(x) length(unique(na.omit(x))) == 1)]
mcar_test(df)
glimpse(df_num)
df_num <- as.data.frame(lapply(df, function(x) as.numeric(as.character(x))))
glimpse(df_num)
mcar_test(df_num)
sapply(df_num, function(x) any(is.nan(x) | is.infinite(x)))
install.packages("BaylorEdPsych")
mcar_test(df_num)
glimpse(df_num)
View(df_num)
install.packages("MVN")
library(MVN)
# df_num phải là numeric
mcar_result <- MVN::mcarTest(df_num)
library(MVN)
# df_num phải là numeric
mcar_result <- mcarTest(df_num)
mdf = mice(df, seed = 1234, printFlag = F)
mdf$imp$age
mdf$imp$education_level
mdf$imp$GDM
mdf$imp$mother_diabetes
mdf$imp$father_diabetes
mdf$imp$preterm_birth
mdf$imp$sex
mdf$imp$pregnancy_smoking
mdf$imp$GDM
mdf$imp$preterm_birth
mdf$imp$father_diabetes
mdf$imp$zbmi
mdf$imp$SBP
mdf$imp$mixed_breastfeeding_month
mdf$imp$PSQI_score
mdf$imp$snoring_times_week
mdf$imp$total_carbohydrates
mdf$imp$low_physical_activity_hour_day
mdf$imp$gestational_weight_gain
imputed_df = complete(mdf, action=1)
View(imputed_df)
str(imputed_df)
miss_case_summary(imputed_df)
miss_var_summary(imputed_df)
View(miss_var_summary(imputed_df))
# Nạp toàn bộ các gói cần thiết
library(tidyverse)   # xử lý, trực quan hóa dữ liệu
library(readxl)      # đọc file Excel (.xlsx)
library(openxlsx)    # ghi/xuất Excel
library(psych)       # thống kê mô tả, kiểm định tâm lý
library(car)         # hồi quy, kiểm định mở rộng
library(mice)        # bù dữ liệu thiếu
library(naniar)      # kiểm tra & trực quan hóa dữ liệu thiếu
df <- read_excel("risk_factors.xlsx")
head(df)
glimpse(df)
str(df)
miss_var_summary(df)
df_num <- as.data.frame(lapply(df, function(x) as.numeric(as.character(x))))
glimpse(df_num)
mdf = mice(df, seed = 1234, printFlag = F)
mdf$imp$gestational_weight_gain
imputed_df <- complete(mdf, action=1)
str(imputed_df)
miss_var_summary(imputed_df)
# Nạp toàn bộ các gói cần thiết
library(tidyverse)   # xử lý, trực quan hóa dữ liệu
library(readxl)      # đọc file Excel (.xlsx)
library(openxlsx)    # ghi/xuất Excel
library(psych)       # thống kê mô tả, kiểm định tâm lý
library(car)         # hồi quy, kiểm định mở rộng
library(mice)        # bù dữ liệu thiếu
library(naniar)      # kiểm tra & trực quan hóa dữ liệu thiếu
df <- read_excel("risk_factors.xlsx")
head(df)
glimpse(df)
str(df)
miss_var_summary(df)
df_num <- as.data.frame(lapply(df, function(x) as.numeric(as.character(x))))
glimpse(df_num)
mdf = mice(df, seed = 1234, printFlag = F)
mdf$imp$gestational_weight_gain
imputed_df <- complete(mdf, action=1)
str(imputed_df)
miss_var_summary(imputed_df)
names(mdf$imp)
# Nạp toàn bộ các gói cần thiết
library(tidyverse)   # xử lý, trực quan hóa dữ liệu
library(readxl)      # đọc file Excel (.xlsx)
library(openxlsx)    # ghi/xuất Excel
library(psych)       # thống kê mô tả, kiểm định tâm lý
library(car)         # hồi quy, kiểm định mở rộng
library(mice)        # bù dữ liệu thiếu
library(naniar)      # kiểm tra & trực quan hóa dữ liệu thiếu
df <- read_excel("risk_factors.xlsx")
head(df)
glimpse(df)
str(df)
miss_var_summary(df)
df_num <- as.data.frame(lapply(df, function(x) as.numeric(as.character(x))))
glimpse(df_num)
mdf = mice(df_num, seed = 1234, printFlag = F)
mdf$imp$gestational_weight_gain
imputed_df <- complete(mdf, action=1)
str(imputed_df)
miss_var_summary(imputed_df)
names(mdf$imp)
View(mdf)
View(imputed_df)
miss_var_summary(imputed_df)
View(miss_var_summary(imputed_df))
View(imputed_df)
str(df_num)
# Nạp toàn bộ các gói cần thiết
library(tidyverse)   # xử lý, trực quan hóa dữ liệu
library(readxl)      # đọc file Excel (.xlsx)
library(openxlsx)    # ghi/xuất Excel
library(psych)       # thống kê mô tả, kiểm định tâm lý
library(car)         # hồi quy, kiểm định mở rộng
library(mice)        # bù dữ liệu thiếu
library(naniar)      # kiểm tra & trực quan hóa dữ liệu thiếu
df <- read_excel("risk_factors.xlsx")
head(df)
glimpse(df)
str(df)
miss_var_summary(df)
df_num <- as.data.frame(lapply(df, function(x) as.numeric(as.character(x))))
glimpse(df_num)
df$CES_D <- as.numeric(df$CES_D)
df$PSS <- as.numeric(df$PSS)
df$RSE <- as.numeric(df$RSE)
mdf = mice(df_num, seed = 1234, printFlag = F)
mdf$imp$gestational_weight_gain
imputed_df <- complete(mdf, action=1)
str(imputed_df)
miss_var_summary(imputed_df)
str(df_num)
View(imputed_df)
glimpse(imputed_df)
imputed_df <- complete(mdf, action=3)
glimpse(imputed_df)
miss_var_summary(imputed_df)
imputed_df <- complete(mdf, action=5)
glimpse(imputed_df)
miss_var_summary(imputed_df)
imputed_df <- complete(mdf, action=3)
glimpse(imputed_df)
miss_var_summary(imputed_df)
imputed_df <- complete(mdf, action=1)
glimpse(imputed_df)
miss_var_summary(imputed_df)
imputed_df <- complete(mdf, action=2)
glimpse(imputed_df)
imputed_df <- complete(mdf, action=4)
glimpse(imputed_df)
load("C:/Users/namtu/learn-code/insulin_re/.RData")
View(imputed_df)
install.packages("writexl")
head(df)
library(tidyverse)   # xử lý, trực quan hóa dữ liệu
library(readxl)      # đọc file Excel (.xlsx)
library(openxlsx)    # ghi/xuất Excel
library(psych)       # thống kê mô tả, kiểm định tâm lý
library(car)         # hồi quy, kiểm định mở rộng
library(mice)        # bù dữ liệu thiếu
library(naniar)
df <- read_excel("risk_factors.xlsx")
head(df)
View(glimpse(df))
dim(df)
summary(df)
str(df)
nrow(df)
ncol(df)
type(ncol(df))
str(df)
glimpse(df)
solSums(is.na(df))
View(summary(df))
names(df)
df_1 <- df |>
select(-all_of(binary_name))
binary_name <- c('sex',
'pregnancy_smoking',
'GDM',
'preterm_birth',
'father_diabetes',
'mother_diabetes',
'education_level')
df_1 <- df |>
select(-all_of(binary_name))
View(missing_vả_summary(df_1))
View(missing_var_summary(df_1))
library(tidyverse)   # xử lý, trực quan hóa dữ liệu
library(readxl)      # đọc file Excel (.xlsx)
library(openxlsx)    # ghi/xuất Excel
library(psych)       # thống kê mô tả, kiểm định tâm lý
library(car)         # hồi quy, kiểm định mở rộng
library(mice)        # bù dữ liệu thiếu
library(naniar)
df <- read_excel("risk_factors.xlsx")
head(df)
str(df)
glimpse(df)
names(df)
binary_name <- c('sex',
'pregnancy_smoking',
'GDM',
'preterm_birth',
'father_diabetes',
'mother_diabetes',
'education_level')
df_1 <- df |>
select(-all_of(binary_name))
View(missing_var_summary(df_1))
View(missing_case_summary(df_1))
miss_var_summary(df)
miss_var_summary(df_1)
View(miss_var_summary(df_1))
summary(df_1)
View(summary(df_1))
df_1 |> count(sex, sort = T)
df_1 |> count('sex', sort = T)
df_1.select("sex")
df_1 |> count('sex', sort = T)
df |>
group_by("sex") |>
summarise(so_luong = n()) |>
arrange(desc(so_luong))
df |>
group_by("sex") |>
summarise(so_luong = n()) |>
arrange(desc(so_luong))
mcar_test(df_1)
df_1 <- df |>
select(1:3)
str(df_1)
miss_var_summary(df_1)
mcar_test(df_1)
df_numeric <- select(df, where(is.numeric()))
df_numeric <- df |> select(where(is.numeric()))
df_numeric <- df |> select(where(is.numeric)
df_numeric <- df |> select(where(is.numeric)
df_numeric <- df |> select(where(is.numeric))
gg_miss_var(df_numeric)
df %>%
summarise(across(everything(), ~var(., na.rm = TRUE))) %>%
select(where(~ . == 0)) %>%
names()
df_1 <- df |> select(1:5)
library(tidyverse)   # xử lý, trực quan hóa dữ liệu
library(readxl)      # đọc file Excel (.xlsx)
library(openxlsx)    # ghi/xuất Excel
library(psych)       # thống kê mô tả, kiểm định tâm lý
library(car)         # hồi quy, kiểm định mở rộng
library(mice)        # bù dữ liệu thiếu
library(naniar)
df <- read_excel("risk_factors.xlsx")
head(df)
str(df)
glimpse(df)
names(df)
binary_name <- c('sex',
'pregnancy_smoking',
'GDM',
'preterm_birth',
'father_diabetes',
'mother_diabetes',
'education_level')
df_1 <- df |> select(1:5)
View(df_numeric)
mcar_test(df_1)
df_1 <- df |> select(1:10)
mcar_test(df_1)
df_1 <- df |> select(1:20)
mcar_test(df_1)
df_1 <- df |> select(1:30)
mcar_test(df_1)
df_1 <- df |> select(1:40)
mcar_test(df_1)
df_1 <- df |> select(1:35)
mcar_test(df_1)
df_1 <- df |> select(1:30)
mcar_test(df_1)
name(df)
names(df)
mdf = mice(df_num, seed = 1234, printFlag = F)
mdf = mice(df, seed = 1234, printFlag = F)
library(tidyverse)   # xử lý, trực quan hóa dữ liệu
library(readxl)      # đọc file Excel (.xlsx)
library(openxlsx)    # ghi/xuất Excel
library(psych)       # thống kê mô tả, kiểm định tâm lý
library(car)         # hồi quy, kiểm định mở rộng
library(mice)        # bù dữ liệu thiếu
library(naniar)
df <- read_excel("risk_factors.xlsx")
head(df)
str(df)
glimpse(df)
names(df)
binary_name <- c('sex',
'pregnancy_smoking',
'GDM',
'preterm_birth',
'father_diabetes',
'mother_diabetes',
'education_level')
mdf = mice(df, seed = 1234, printFlag = F)
mdf$imp$gestational_weight_gain
View(mdf)
View(mdf)
typeof(mdf$imp$gestational_weight_gain)
imputed_df <- complete(mdf, action=1)
glimpse(imputed_df)
miss_var_summary(imputed_df)
# Nạp toàn bộ các gói cần thiết
library(tidyverse)   # xử lý, trực quan hóa dữ liệu
library(readxl)      # đọc file Excel (.xlsx)
library(openxlsx)    # ghi/xuất Excel
library(psych)       # thống kê mô tả, kiểm định tâm lý
library(car)         # hồi quy, kiểm định mở rộng
library(mice)        # bù dữ liệu thiếu
library(naniar)      # kiểm tra & trực quan hóa dữ liệu thiếu
df <- read_excel("risk_factors.xlsx")
head(df)
glimpse(df)
str(df)
miss_var_summary(df)
df <- read_excel("risk_factors.xlsx")
View(miss_var_summary(df))
mcar_test(df)
df_1 <- df |> select(1:10)
mcar_test(df_1)
df_1 <- df |> select(1:20)
mcar_test(df_1)
df_1 <- df |> select(1:30)
mcar_test(df_1)
df_1 <- df |> select(1:40)
mcar_test(df_1)
pool_df = mice(df, seed = 1234, printFlag = F)
pool_df$imp$gestational_weight_gain
imputed_df <- complete(pool_df, action=1)
glimpse(imputed_df)
# Nạp toàn bộ các gói cần thiết
library(tidyverse)   # xử lý, trực quan hóa dữ liệu
library(readxl)      # đọc file Excel (.xlsx)
library(openxlsx)    # ghi/xuất Excel
library(psych)       # thống kê mô tả, kiểm định tâm lý
library(car)         # hồi quy, kiểm định mở rộng
library(mice)        # bù dữ liệu thiếu
library(naniar)      # kiểm tra & trực quan hóa dữ liệu thiếu
df <- read_excel("risk_factors.xlsx")
head(df)
glimpse(df)
str(df)
miss_var_summary(df)
mcar_test(df)
mcar_test(select(df, 1:30))
pool_df = mice(df, seed = 1234, printFlag = F)
pool_df$imp$gestational_weight_gain
imputed_df <- complete(pool_df, action=4)
glimpse(imputed_df)
View(miss_var_summary(imputed_df))
write.csv(imputed_df, "imputed_data.csv", row.names = FALSE)
library(writexl)     # một package khác để xuất file excel
# Nạp toàn bộ các gói cần thiết
library(tidyverse)   # xử lý, trực quan hóa dữ liệu
library(readxl)      # đọc file Excel (.xlsx)
library(openxlsx)    # ghi/xuất Excel
library(psych)       # thống kê mô tả, kiểm định tâm lý
library(car)         # hồi quy, kiểm định mở rộng
library(mice)        # bù dữ liệu thiếu
library(naniar)      # kiểm tra & trực quan hóa dữ liệu thiếu
library(writexl)     # một package khác để xuất file excel
df <- read_excel("risk_factors.xlsx")
head(df)
glimpse(df)
str(df)
miss_var_summary(df)
pool_df = mice(df, seed = 1234, printFlag = F)
pool_df$imp$gestational_weight_gain
imputed_df <- complete(pool_df, action=4)
glimpse(imputed_df)
View(miss_var_summary(imputed_df))
# write.csv(imputed_df, "imputed_data.csv", row.names = FALSE)
write_xlsx(imputed_df, "imputed_data.xlsx")
